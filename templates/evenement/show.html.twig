{% extends 'base.html.twig' %}

{% block title %}Evenement{% endblock %}

{% block body %}

    <main id="main" >
        <style>
            .mgt{
                margin-top: -50px;
            }
            section {
                padding: 10px ;
                overflow: hidden;
            }

            .section-title h2 {

                font-size: 14px;
                padding-top: 70px;
                line-height: 1px;
                margin: 0 0 5px 0;
                letter-spacing: 2px;
                text-transform: uppercase;
                color: #aaaaaa;
                font-family: "Poppins", sans-serif;
            }

            .section-title h2::after {
                content: "";
                width: 120px;
                height: 1px;
                display: inline-block;
                background: var(--color-primary);
                margin: 4px 10px;
            }




            /*--------------------------------------------------------------
            # Contact
            --------------------------------------------------------------*/

            .contact .info i {
                font-size: 20px;
                background: var(--color-secondary);
                color: white;
                float: left;
                width: 44px;
                height: 44px;
                display: flex;
                justify-content: center;
                align-items: center;
                border-radius: 4px;
                transition: all 0.3s ease-in-out;
            }

            .contact .info h4 {
                padding: 0 0 0 60px;
                margin-bottom: 5px;
            }

            .contact .info p {
                padding: 0 0 0 60px;
                margin-bottom: 0;
                color: #484848;
            }

            .contact .info .email,
            .contact .info .address,
            .contact .info .phone {
                margin-top: 10px;
            }


        </style>
        <!-- ======= Breadcrumbs ======= -->
        <div class="breadcrumbs">
            <div class="page-header d-flex align-items-center" style="background-image: url('../frontOffice/assets/img/page-header.jpg');">
                <div class="container position-relative">
                    <div class="row d-flex justify-content-center">
                        <div class="col-lg-6 text-center">
                            <h2>{{ evenement.nom }}</h2>

                        </div>
                    </div>
                </div>
            </div>
            <nav>
                <div class="container">
                    <ol>
                        <li><a href="{{ path('app_evenement_index') }}">Evenements</a></li>
                        <li><a href="{{ path('app_evenement_show', {'id': evenement.id}) }}">{{ evenement.nom }}</a></li>
                    </ol>
                </div>
            </nav>
        </div><!-- End Breadcrumbs -->


        <section id="service-details" class="service-details" data-aos="fade-up">
            <div class="container" >
                <div class="row gy-4">

                    <div class="col-lg-4">
                        <nav id="sidenav" class="sidenav">
                        <div class="services-list">
                            <a href="#" class="nav-link scrollto active">Description</a>
                            <a href="#Session" class="nav-link scrollto ">Session</a>
                            <a href="#Location"class="nav-link scrollto " >Location</a>
                            <a href="#contact"class="nav-link scrollto " >Contact</a>
                            <a href="#comments"class="nav-link scrollto " >Comments</a>
                        </div>
                        </nav><!-- .nav-menu -->
                        <div class="col">
                            <form method="post" action="{{ path('app_reservation_new', {'eventId': evenement.id}) }}">
                                <button class="btn">next</button>
                            </form>
                            <button class="btn text-white" id="like-button" data-event-id="{{ evenement.id}}" onclick="likeEvent()" style="background-color: #3b5998;">
                                <span >
                                        <i class="fa fa-thumbs-o-up" ></i>
                                        <span class="text like" id="like-text">{% if jaime %}liked{% else %}like{% endif %}</span>
                                        <span class="text number" id="like-number">{{ count }}</span></span>
                            </button>

                        </div>



                    </div>
                    <div class="col-lg-8" >
                        <section id="Description" class="Description " >
                            <img src="../frontOffice/assets/img/logotha9afans.png" alt="" class="img-fluid services-img"style="width:50%">
                            <div class="section-title">
                               <h2>Description</h2>
                            </div>
                            <h3>{{ evenement.nom }}</h3>
                            <p style="word-wrap: break-word">
                                {{ evenement.description }}
                                <br>
                                {{ evenement.date ? evenement.date|date('Y-m-d') : '' }}
                            </p>
                        </section>


                        <section id="Session" class="Session mgt" >
                            <div class="section-title">
                                <h2>Sessions</h2>
                            </div>
                            {{ include('session/index.html.twig') }}
                        </section>

                        <section id="Location" class="Location mgt" >
                            <div class="section-title">
                                <h2>Location</h2>
                            </div>
                            <div id="map" style="height: 400px;"></div>
                            <body onload="initMap()">
                            </body>
                            <div >
                                <h4><i class="bi bi-geo-alt"></i>Address:</h4>
                                <p>{{ evenement.addresse }}</p>
                            </div>
                        </section>
                        <section id="contact" class="contact mgt" >
                                <div class="section-title">
                                    <h2>Contact</h2>
                                    <p>Contact Us</p>
                                </div>
                                <div class="info">
                                     <div class="row mt-5">
                                        <div class="col-lg-4">
                                            <div class="address">
                                            <i class="bi bi-geo-alt"></i>
                                            <h4>Address:</h4>
                                            <p>{{ evenement.createur.adresse }}</p>
                                        </div>
                                        </div>
                                        <div class="col-lg-4">
                                            <div class="phone">
                                                <i class="bi bi-phone"></i>
                                                <h4>Call:</h4>
                                                <p>{{ evenement.createur.telephone }}</p>
                                            </div>
                                        </div>
                                        <div class="col-lg-4">
                                            <div class="email">
                                                <i class="bi bi-envelope"></i>
                                                <h4>Email:</h4>
                                                <p>{{ evenement.createur.email }}</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                        </section>

                        <section id="comments" class="comments mgt" >
                            <div class="section-title">
                                <h2>comments</h2>
                            </div>
                            {{ include('commentaire/index.html.twig') }}
                        </section>
                    </div>
                </div>
            </div>
        </section>
    </main><!-- End #main -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCV0g2hrrJIe78gzxlc5my8ly_cL20ZKvE"></script>
    <script>
        const position = JSON.parse('{{ evenement.localisation|raw }}');
        console.log(position);
        function initMap() {
            const map = new google.maps.Map(document.getElementById("map"), {
                zoom: 9,
                center: position
            });
            const marker = new google.maps.Marker({
                position: position,
                map: map
            });
        }

        function likeEvent() {
            const button = document.getElementById('like-button');
            const liketext = document.getElementById('like-text');
            const likenumber = document.getElementById('like-number');
            const eventId = button.getAttribute('data-event-id');

            fetch(`/jaime/${eventId}`, {
                method: 'POST'
            }).then(response => {
                if (response.ok) {

                    return response.json();
                } else {
                    console.log(response);
                    throw new Error('Network response was not ok');
                }
            }).then(data => {
                if (data.action === 'liked') {
                    liketext.textContent = 'liked';
                    likenumber.textContent=data.number;
                    button.classList.add('liked');
                } else if (data.action === 'unliked') {
                    liketext.textContent = 'Like';
                    likenumber.textContent=data.number;
                    button.classList.remove('liked');
                }
            }).catch(error => {
                console.error('Error:', error);
            });
        }
    </script>
{% endblock %}
