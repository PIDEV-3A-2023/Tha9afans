{% extends 'backBase.html.twig' %}

{% block body %}
    <div class="container" >
        <div class="row" style="margin-top: 50px">
            <div class="col-md-3" >
                <div class="card" style="background-color: #F1FAEE">
                    <div class="card-body">
                        <i class="fa fa-users fa-3x" style="color: #001A23"></i>
                        <h5 class="card-title mt-3">Nombre d'utilisateurs :</h5>
                        <h3 class="card-title text-nowrap mb-1">{{ userCount }}</h3>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card" style="background-color: #F1FAEE">
                    <div class="card-body">
                        <i class="fa fa-shopping-cart fa-3x" style="color: #001A23"></i>
                        <h5 class="card-title mt-3">Nombre de produits :</h5>
                        <h3 class="card-title text-nowrap mb-1">{{ productCount }}</h3>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card" style="background-color: #F1FAEE">
                    <div class="card-body">
                        <i class="fa fa-calendar fa-3x" style="color: #001A23"></i>
                        <h5 class="card-title mt-3">Nombre d'événements :</h5>
                        <h3 class="card-title text-nowrap mb-1">{{ eventCount }}</h3>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card" style="background-color: #F1FAEE">
                    <div class="card-body">
                        <i class="fa fa-question-circle fa-3x" style="color: #001A23"></i>
                        <h5 class="card-title mt-3">Nombre de quiz :</h5>
                        <h3 class="card-title text-nowrap mb-1"> {{ quizCount }}</h3>
                    </div>
                </div>
            </div>
        </div>

        <div class="container" style="margin-top: 50px" >
            <canvas id="myChart" width="150" height="50"></canvas>
        </div>
        <h3>Répartition par age et genre</h3>
        <div class="container" style="margin-top: 20px" >
            <div class="row">
                <canvas id="pieChart" width="20px" height="20px"></canvas>
                <canvas id="pieChartgenre" width="20px" height="20px"></canvas>
            </div>
        </div>

    </div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        var labels = {{ labels|raw }};
        var data = {{ data|raw }};
        var datapie = {{ datapie|raw }};
        var datapiegenre = JSON.parse('{{ datapiegenre|raw }}'); // Parse the string as a JSON object
        var pieChart = new Chart(document.getElementById("pieChart"), {
            type: 'pie',
            data: {
                labels: ["< 18", ">= 18"],
                datasets: [{
                    label: 'Age',
                    data: [datapie.age['< 18'], datapie.age['>= 18']],
                    backgroundColor: ['#FF6384', '#36A2EB'],
                    borderColor: ['#FF6384', '#36A2EB'],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                title:{
                    display: true,
                    text: 'Répartition par genre (moins de 18 ans)',
                    fontSize: 20,
                    padding: 20,
                }
            }});
        pieChart.resize(500,500);

        var ctx = document.getElementById('myChart').getContext('2d');
        var chart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Nombre d\'utilisateurs par région',
                    data: data,
                    backgroundColor: '#1D3557',
                    borderColor: '#457B9D',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

        var myPieChartgenre = new Chart(document.getElementById("pieChartgenre"), {
            type: 'pie',
            data: {
                labels: ['Femme', 'Homme', 'Autre'],
                datasets: [{
                    data: [
                        datapiegenre['genre']['femme'],
                        datapiegenre['genre']['homme'],
                        datapiegenre['genre']['autre']
                    ],
                    backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56']
                }]
            },
            options: {
                responsive: true,
            }
        });
        myPieChartgenre.resize(500,500);
    </script>

{% endblock %}
